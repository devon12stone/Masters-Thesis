% Appendix Template

\chapter{Python Program for Behaviour Simulation} % Main appendix title

\label{AppendixB} % Change X to a consecutive letter; for referencing this appendix elsewhere, use \ref{AppendixX}

\begin{lstlisting}


# Modules Used
import arcpy
from arcpy import env
from arcpy.sa import *
import Obs_Reader as obs
import numpy as np


arcpy.CheckOutExtension("Spatial")#checks for the spaltial license tool

obs_list = obs.observations_reader("Weather_Data.csv") #using observation reader in Obs_Reader module


def fire_behaviour(observations_list):
    #Input: 
    #A raster of Fuel Moisture Content calculated from NDWI using ARCGIS
    #A raster of fuel load using ARCGIS
    #hourly weather statistics
    #the constants used in burning index, flame length, and flame angle formulae

    #outputs:
    #a burning index raster for every hour observation
    #possible flame_length for every pixel
    #possible flame_angle for every pixel

    count = 0

    env.workspace = r"C:\Users\User\Documents\Devon Stone\Model Data" #input environment
    moisture_content = Raster("Moisture_Content.tif") / 100.0
    fuel_load = Raster("Fuel_Load.tif")
    moisture_content_root = SquareRoot(moisture_content)

    for row in observations_list:


        obs_date = row[0]
        obs_time = row[1]
        obs_rain = row[2]
        obs_temp = row[3]
        obs_wind = row[4]
        obs_dir  = row[5]
        obs_humidity = row[6] / 100.0

        fire_intensity = 2729.0 + (0.8684*(fuel_load*1000)) - (530.0*(moisture_content_root)) - (0.907 * obs_humidity * obs_humidity) - (596.0*(1.0/obs_wind))

        fire_intensity = arcpy.sa.Con(fuel_load == 0, 0, fire_intensity) #statement saying set FI to zero if there is no fuel in that pixel

        max_fire_intensity = fire_intensity.maximum
        min_fire_intensity  = fire_intensity.minimum
        fire_intensity_range = max_fire_intensity - min_fire_intensity

        intenisty_index = (fire_intensity - min_fire_intensity)/fire_intensity_range
     
        env.workspace = r"C:\Users\User\Documents\Devon Stone\\Fire_Intensity"
        env.overwriteOutput = True
        fire_intensity.save(str(count) + "Fire_Intensity.tif")
        intenisty_index.save(str(count) + "Fire_Intenisty_Index.tif")


        print(count)
        count += 1
        

\end{lstlisting}